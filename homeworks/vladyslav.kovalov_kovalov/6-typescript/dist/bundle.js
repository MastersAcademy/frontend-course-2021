/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
var __webpack_exports__ = {};
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/

class Game {
    constructor(currentKeyElement, totalScoreElement, roundScoreElement, balloonElement, progressElement) {
        this.currentKeyElement = currentKeyElement;
        this.totalScoreElement = totalScoreElement;
        this.roundScoreElement = roundScoreElement;
        this.balloonElement = balloonElement;
        this.progressElement = progressElement;
        this.paused = true;
        this.LETTERS = "abcdefghijklmnopqrstuvwxyz";
        this.INTERVAL = 2000;
        this.FINAL_SCORE = 200;
        this.currentKey = '';
        this.score = 100;
        this.timer = 0;
    }
    getRandomLetterPosition(letterString) {
        return Math.floor(Math.random() * letterString.length);
    }
    getRandomLetter(letterString) {
        return letterString[this.getRandomLetterPosition(letterString)];
    }
    getRandomScore(min, max) {
        return Math.floor(Math.random() * (max - min) + min);
    }
    setRandomKey() {
        const randomLetter = this.getRandomLetter(this.LETTERS);
        this.currentKey = randomLetter.toUpperCase();
        this.currentKeyElement.textContent = this.currentKey;
    }
    setRoundScore(score, action) {
        this.roundScoreElement.textContent = `${action}${score}`;
    }
    updateTotalScore() {
        this.totalScoreElement.textContent = `${this.score.toString()}`;
    }
    increaseBalloon() {
        let width = this.balloonElement.offsetWidth;
        let height = this.balloonElement.offsetWidth;
        this.balloonElement.style.height = `${height + 5}px`;
        this.balloonElement.style.width = `${width + 5}px`;
    }
    decreaseBaloon() {
        let width = this.balloonElement.offsetWidth;
        let height = this.balloonElement.offsetWidth;
        this.balloonElement.style.height = `${height - 5}px`;
        this.balloonElement.style.width = `${width - 5}px`;
    }
    reset() {
        clearInterval(this.timer);
        this.timer = 0;
        this.progressElement.style.width = '100%';
    }
    renderEndGame(message) {
        clearInterval(this.timer);
        this.reset();
        this.totalScoreElement.textContent = message;
        this.roundScoreElement.innerHTML = '0';
        this.paused = true;
    }
    checkScore() {
        if (this.score <= 0) {
            this.renderEndGame('You lose!');
        }
        if (this.score >= 200) {
            this.renderEndGame('You won!');
        }
    }
    addScore() {
        const min = 5;
        const max = 10;
        const currentScore = this.getRandomScore(min, max);
        this.score += currentScore;
        this.setRoundScore(currentScore, '+');
        this.updateTotalScore();
        this.increaseBalloon();
    }
    removeScore() {
        const min = 20;
        const max = 25;
        const currentScore = this.getRandomScore(min, max);
        this.score -= currentScore;
        this.setRoundScore(currentScore, '-');
        this.updateTotalScore();
        this.decreaseBaloon();
    }
    checkPressedKey(key) {
        if (key === this.currentKey) {
            clearInterval(this.timer);
            return this.addScore();
        }
        ;
        if (key !== this.currentKey) {
            clearInterval(this.timer);
            return this.removeScore();
        }
        ;
    }
    start() {
        this.setRandomKey();
    }
    setTimer() {
        let step = 10;
        let counter = 100;
        this.timer = window.setInterval(() => {
            if (counter >= 0) {
                this.progressElement.style.width = counter + '%';
                counter -= step;
                return;
            }
            clearInterval(this.timer);
            const min = 10;
            const max = 15;
            const currentScore = this.getRandomScore(min, max);
            this.score -= currentScore;
            this.setRoundScore(currentScore, '-');
            this.updateTotalScore();
            this.decreaseBaloon();
            if (this.score > 0) {
                game.setRandomKey();
                this.setTimer();
            }
            game.checkScore();
        }, this.INTERVAL / 10);
    }
    buttonStart() {
        this.paused = false;
        this.reset();
        this.roundScoreElement.innerHTML = '0';
        this.currentKey = '';
        this.score = 100;
        this.totalScoreElement.textContent = `${this.score}`;
        this.start();
        this.setTimer();
        this.setRandomKey();
    }
    buttonEnd() {
        this.paused = true;
        this.reset();
        this.currentKey = '';
        this.totalScoreElement.textContent = 'You lose!';
        this.roundScoreElement.innerHTML = '0';
    }
    buttonRestart() {
        this.reset();
        this.roundScoreElement.innerHTML = '0';
        this.currentKey = '';
        this.score = 100;
        this.totalScoreElement.textContent = `${this.score}`;
    }
}
const currentKeyElement = document.querySelector('[data-current-key]');
const totalScoreElement = document.querySelector('[data-total-score]');
const roundScoreElement = document.querySelector('[data-round-score]');
const balloonElement = document.querySelector('[data-balloon-item]');
const progressElement = document.querySelector('[data-progress]');
const buttonsContainerElement = document.querySelector('[data-buttons-container]');
const game = new Game(currentKeyElement, totalScoreElement, roundScoreElement, balloonElement, progressElement);
game.start();
document.addEventListener('keydown', e => {
    game.checkScore();
    const pressedKey = e.key.toUpperCase();
    if (!game.paused) {
        game.checkPressedKey(pressedKey);
        game.setRandomKey();
        game.setTimer();
    }
});
buttonsContainerElement.addEventListener('click', event => {
    if (event.target instanceof HTMLElement && event.target.dataset.action !== '') {
        if (event.target.dataset.action === 'start')
            game.buttonStart();
        if (event.target.dataset.action === 'end')
            game.buttonEnd();
        if (event.target.dataset.action === 'restart')
            game.buttonRestart();
    }
});

/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUdiLFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxDQUFDLEVBQUU7SUFDckMsSUFBSSxDQUFDLFVBQVUsRUFBRSxDQUFDO0lBQ2xCLE1BQU0sVUFBVSxHQUFXLENBQUMsQ0FBQyxHQUFHLENBQUMsV0FBVyxFQUFFLENBQUM7SUFDL0MsSUFBRyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUU7UUFDYixJQUFJLENBQUMsZUFBZSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQ2pDLElBQUksQ0FBQyxZQUFZLEVBQUUsQ0FBQztRQUNwQixJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7S0FDbkI7QUFDTCxDQUFDLENBQUMsQ0FBQztBQUVILHVCQUF1QixDQUFDLGdCQUFnQixDQUFDLE9BQU8sRUFBRSxLQUFLLENBQUMsRUFBRTtJQUN0RCxJQUFHLEtBQUssQ0FBQyxNQUFNLFlBQVksV0FBVyxJQUFJLEtBQUssQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLE1BQU0sS0FBSyxFQUFFLEVBQUU7UUFDMUUsSUFBRyxLQUFLLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxNQUFNLEtBQUssT0FBTztZQUFFLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUMvRCxJQUFHLEtBQUssQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLE1BQU0sS0FBSyxLQUFLO1lBQUUsSUFBSSxDQUFDLFNBQVMsRUFBRSxDQUFDO1FBQzNELElBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsTUFBTSxLQUFLLFNBQVM7WUFBRSxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7S0FDdEU7QUFDTCxDQUFDLENBQUUsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovLzYtdHlwZXNjcmlwdC8uL3NyYy9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBHYW1lIHtcbiAgICBwdWJsaWMgcGF1c2VkOiBib29sZWFuID0gdHJ1ZTtcbiAgICBwcml2YXRlIExFVFRFUlM6IHN0cmluZyA9IFwiYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXpcIjtcbiAgICBwcml2YXRlIElOVEVSVkFMOiBudW1iZXIgPSAyMDAwO1xuICAgIHByaXZhdGUgRklOQUxfU0NPUkU6IG51bWJlciA9IDIwMDtcbiAgICBwcml2YXRlIGN1cnJlbnRLZXk6IHN0cmluZyA9ICcnO1xuICAgIHByaXZhdGUgc2NvcmU6IG51bWJlciA9IDEwMDtcbiAgICBwcml2YXRlIHRpbWVyOiBudW1iZXIgPSAwO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgY3VycmVudEtleUVsZW1lbnQ6IEhUTUxTcGFuRWxlbWVudCxcbiAgICAgICAgcHJpdmF0ZSB0b3RhbFNjb3JlRWxlbWVudDogSFRNTERpdkVsZW1lbnQsXG4gICAgICAgIHByaXZhdGUgcm91bmRTY29yZUVsZW1lbnQ6IEhUTUxEaXZFbGVtZW50LFxuICAgICAgICBwcml2YXRlIGJhbGxvb25FbGVtZW50OiBIVE1MRGl2RWxlbWVudCxcbiAgICAgICAgcHJpdmF0ZSBwcm9ncmVzc0VsZW1lbnQ6IEhUTUxEaXZFbGVtZW50LFxuICAgICkgeyB9XG5cbiAgICBwcml2YXRlIGdldFJhbmRvbUxldHRlclBvc2l0aW9uKGxldHRlclN0cmluZzogc3RyaW5nKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGxldHRlclN0cmluZy5sZW5ndGgpO1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0UmFuZG9tTGV0dGVyKGxldHRlclN0cmluZzogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIGxldHRlclN0cmluZ1t0aGlzLmdldFJhbmRvbUxldHRlclBvc2l0aW9uKGxldHRlclN0cmluZyldO1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0UmFuZG9tU2NvcmUobWluOiBudW1iZXIsIG1heDogbnVtYmVyKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4pICsgbWluKTtcbiAgICB9XG5cbiAgICBzZXRSYW5kb21LZXkoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHJhbmRvbUxldHRlcjogc3RyaW5nID0gdGhpcy5nZXRSYW5kb21MZXR0ZXIodGhpcy5MRVRURVJTKTtcbiAgICAgICAgdGhpcy5jdXJyZW50S2V5ID0gcmFuZG9tTGV0dGVyLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgIHRoaXMuY3VycmVudEtleUVsZW1lbnQudGV4dENvbnRlbnQgPSB0aGlzLmN1cnJlbnRLZXk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzZXRSb3VuZFNjb3JlKHNjb3JlOiBudW1iZXIsIGFjdGlvbjogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIHRoaXMucm91bmRTY29yZUVsZW1lbnQudGV4dENvbnRlbnQgPSBgJHthY3Rpb259JHtzY29yZX1gO1xuICAgIH1cblxuICAgIHByaXZhdGUgdXBkYXRlVG90YWxTY29yZSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy50b3RhbFNjb3JlRWxlbWVudC50ZXh0Q29udGVudCA9IGAke3RoaXMuc2NvcmUudG9TdHJpbmcoKX1gO1xuICAgIH1cblxuICAgIHByaXZhdGUgaW5jcmVhc2VCYWxsb29uKCk6IHZvaWQge1xuICAgICAgICBsZXQgd2lkdGg6IG51bWJlciA9IHRoaXMuYmFsbG9vbkVsZW1lbnQub2Zmc2V0V2lkdGg7XG4gICAgICAgIGxldCBoZWlnaHQ6IG51bWJlciA9IHRoaXMuYmFsbG9vbkVsZW1lbnQub2Zmc2V0V2lkdGg7XG5cbiAgICAgICAgdGhpcy5iYWxsb29uRWxlbWVudC5zdHlsZS5oZWlnaHQgPSBgJHtoZWlnaHQgKyA1fXB4YDtcbiAgICAgICAgdGhpcy5iYWxsb29uRWxlbWVudC5zdHlsZS53aWR0aCA9IGAke3dpZHRoICsgNX1weGA7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBkZWNyZWFzZUJhbG9vbigpOiB2b2lkIHtcbiAgICAgICAgbGV0IHdpZHRoOiBudW1iZXIgPSB0aGlzLmJhbGxvb25FbGVtZW50Lm9mZnNldFdpZHRoO1xuICAgICAgICBsZXQgaGVpZ2h0OiBudW1iZXIgPSB0aGlzLmJhbGxvb25FbGVtZW50Lm9mZnNldFdpZHRoO1xuXG4gICAgICAgIHRoaXMuYmFsbG9vbkVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gYCR7aGVpZ2h0IC0gNX1weGA7XG4gICAgICAgIHRoaXMuYmFsbG9vbkVsZW1lbnQuc3R5bGUud2lkdGggPSBgJHt3aWR0aCAtIDV9cHhgO1xuICAgIH1cblxuICAgIHByaXZhdGUgcmVzZXQoKTogdm9pZCB7XG4gICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy50aW1lcik7XG4gICAgICAgIHRoaXMudGltZXIgPSAwO1xuICAgICAgICB0aGlzLnByb2dyZXNzRWxlbWVudC5zdHlsZS53aWR0aCA9ICcxMDAlJztcbiAgICB9XG5cbiAgICBwcml2YXRlIHJlbmRlckVuZEdhbWUobWVzc2FnZTogc3RyaW5nKTogdm9pZHtcbiAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnRpbWVyKTtcbiAgICAgICAgdGhpcy5yZXNldCgpO1xuICAgICAgICB0aGlzLnRvdGFsU2NvcmVFbGVtZW50LnRleHRDb250ZW50ID0gbWVzc2FnZTtcbiAgICAgICAgdGhpcy5yb3VuZFNjb3JlRWxlbWVudC5pbm5lckhUTUwgPSAnMCc7XG4gICAgICAgIHRoaXMucGF1c2VkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgY2hlY2tTY29yZSgpOiB2b2lkIHtcbiAgICAgICAgaWYodGhpcy5zY29yZSA8PSAwKSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlckVuZEdhbWUoJ1lvdSBsb3NlIScpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYodGhpcy5zY29yZSA+PSAyMDApIHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyRW5kR2FtZSgnWW91IHdvbiEnKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgYWRkU2NvcmUoKTogdm9pZCB7XG4gICAgICAgICAgICBjb25zdCBtaW46IG51bWJlciA9IDU7XG4gICAgICAgICAgICBjb25zdCBtYXg6IG51bWJlciA9IDEwO1xuXG4gICAgICAgICAgICBjb25zdCBjdXJyZW50U2NvcmU6IG51bWJlciA9IHRoaXMuZ2V0UmFuZG9tU2NvcmUobWluLCBtYXgpO1xuICAgICAgICAgICAgdGhpcy5zY29yZSArPSBjdXJyZW50U2NvcmU7XG4gICAgICAgICAgICB0aGlzLnNldFJvdW5kU2NvcmUoY3VycmVudFNjb3JlLCAnKycpO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVUb3RhbFNjb3JlKCk7XG4gICAgICAgICAgICB0aGlzLmluY3JlYXNlQmFsbG9vbigpXG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZW1vdmVTY29yZSgpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgbWluOiBudW1iZXIgPSAyMDtcbiAgICAgICAgY29uc3QgbWF4OiBudW1iZXIgPSAyNTtcblxuICAgICAgICBjb25zdCBjdXJyZW50U2NvcmU6IG51bWJlciA9IHRoaXMuZ2V0UmFuZG9tU2NvcmUobWluLCBtYXgpO1xuICAgICAgICB0aGlzLnNjb3JlIC09IGN1cnJlbnRTY29yZTtcbiAgICAgICAgdGhpcy5zZXRSb3VuZFNjb3JlKGN1cnJlbnRTY29yZSwgJy0nKTtcbiAgICAgICAgdGhpcy51cGRhdGVUb3RhbFNjb3JlKCk7XG4gICAgICAgIHRoaXMuZGVjcmVhc2VCYWxvb24oKVxuICAgIH1cblxuICAgIGNoZWNrUHJlc3NlZEtleShrZXk6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBpZiAoa2V5ID09PSB0aGlzLmN1cnJlbnRLZXkpIHtcbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy50aW1lcik7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hZGRTY29yZSgpXG4gICAgICAgIH07XG4gICAgICAgIGlmIChrZXkgIT09IHRoaXMuY3VycmVudEtleSkge1xuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnRpbWVyKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbW92ZVNjb3JlKClcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBzdGFydCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zZXRSYW5kb21LZXkoKTtcbiAgICB9XG5cbiAgICBzZXRUaW1lcigpOiB2b2lkIHtcbiAgICAgICAgbGV0IHN0ZXAgPSAxMDtcbiAgICAgICAgbGV0IGNvdW50ZXIgPSAxMDA7XG4gICAgICAgIHRoaXMudGltZXIgPSB3aW5kb3cuc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICAgICAgaWYgKGNvdW50ZXIgPj0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJvZ3Jlc3NFbGVtZW50LnN0eWxlLndpZHRoID0gY291bnRlciArICclJztcbiAgICAgICAgICAgICAgICBjb3VudGVyIC09IHN0ZXA7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMudGltZXIpO1xuXG4gICAgICAgICAgICBjb25zdCBtaW46IG51bWJlciA9IDEwO1xuICAgICAgICAgICAgY29uc3QgbWF4OiBudW1iZXIgPSAxNTtcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRTY29yZTogbnVtYmVyID0gdGhpcy5nZXRSYW5kb21TY29yZShtaW4sIG1heCk7XG4gICAgICAgICAgICB0aGlzLnNjb3JlIC09IGN1cnJlbnRTY29yZTtcbiAgICAgICAgICAgIHRoaXMuc2V0Um91bmRTY29yZShjdXJyZW50U2NvcmUsICctJyk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVRvdGFsU2NvcmUoKTtcbiAgICAgICAgICAgIHRoaXMuZGVjcmVhc2VCYWxvb24oKVxuXG4gICAgICAgIGlmKHRoaXMuc2NvcmUgPiAwKSB7XG4gICAgICAgICAgICBnYW1lLnNldFJhbmRvbUtleSgpO1xuICAgICAgICAgICAgdGhpcy5zZXRUaW1lcigpO1xuICAgICAgICB9XG5cbiAgICAgICAgZ2FtZS5jaGVja1Njb3JlKCk7XG4gICAgICAgIH0sIHRoaXMuSU5URVJWQUwgLyAxMCk7XG4gICAgfVxuXG4gICAgcHVibGljIGJ1dHRvblN0YXJ0KCk6IHZvaWQge1xuICAgICAgICB0aGlzLnBhdXNlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnJlc2V0KCk7XG4gICAgICAgIHRoaXMucm91bmRTY29yZUVsZW1lbnQuaW5uZXJIVE1MID0gJzAnO1xuICAgICAgICB0aGlzLmN1cnJlbnRLZXkgPSAnJztcbiAgICAgICAgdGhpcy5zY29yZSA9IDEwMDtcbiAgICAgICAgdGhpcy50b3RhbFNjb3JlRWxlbWVudC50ZXh0Q29udGVudCA9IGAke3RoaXMuc2NvcmV9YDtcbiAgICAgICAgdGhpcy5zdGFydCgpO1xuICAgICAgICB0aGlzLnNldFRpbWVyKCk7XG4gICAgICAgIHRoaXMuc2V0UmFuZG9tS2V5KCk7XG4gICAgfVxuXG4gICAgcHVibGljIGJ1dHRvbkVuZCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5wYXVzZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLnJlc2V0KCk7XG4gICAgICAgIHRoaXMuY3VycmVudEtleSA9ICcnO1xuICAgICAgICB0aGlzLnRvdGFsU2NvcmVFbGVtZW50LnRleHRDb250ZW50ID0gJ1lvdSBsb3NlISc7XG4gICAgICAgIHRoaXMucm91bmRTY29yZUVsZW1lbnQuaW5uZXJIVE1MID0gJzAnO1xuICAgIH1cblxuICAgIHB1YmxpYyBidXR0b25SZXN0YXJ0KCk6IHZvaWQge1xuICAgICAgICB0aGlzLnJlc2V0KCk7XG4gICAgICAgIHRoaXMucm91bmRTY29yZUVsZW1lbnQuaW5uZXJIVE1MID0gJzAnO1xuICAgICAgICB0aGlzLmN1cnJlbnRLZXkgPSAnJztcbiAgICAgICAgdGhpcy5zY29yZSA9IDEwMDtcbiAgICAgICAgdGhpcy50b3RhbFNjb3JlRWxlbWVudC50ZXh0Q29udGVudCA9IGAke3RoaXMuc2NvcmV9YDtcbiAgICB9XG59XG5cbmNvbnN0IGN1cnJlbnRLZXlFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtY3VycmVudC1rZXldJykgYXMgSFRNTFNwYW5FbGVtZW50O1xuY29uc3QgdG90YWxTY29yZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS10b3RhbC1zY29yZV0nKSBhcyBIVE1MRGl2RWxlbWVudDtcbmNvbnN0IHJvdW5kU2NvcmVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtcm91bmQtc2NvcmVdJykgYXMgSFRNTERpdkVsZW1lbnQ7XG5jb25zdCBiYWxsb29uRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWJhbGxvb24taXRlbV0nKSBhcyBIVE1MRGl2RWxlbWVudDtcbmNvbnN0IHByb2dyZXNzRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXByb2dyZXNzXScpIGFzIEhUTUxEaXZFbGVtZW50O1xuY29uc3QgYnV0dG9uc0NvbnRhaW5lckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1idXR0b25zLWNvbnRhaW5lcl0nKSBhcyBIVE1MRGl2RWxlbWVudDtcblxuY29uc3QgZ2FtZSA9IG5ldyBHYW1lKGN1cnJlbnRLZXlFbGVtZW50LCB0b3RhbFNjb3JlRWxlbWVudCwgcm91bmRTY29yZUVsZW1lbnQsIGJhbGxvb25FbGVtZW50LCBwcm9ncmVzc0VsZW1lbnQpO1xuZ2FtZS5zdGFydCgpO1xuXG5cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBlID0+IHtcbiAgICBnYW1lLmNoZWNrU2NvcmUoKTtcbiAgICBjb25zdCBwcmVzc2VkS2V5OiBzdHJpbmcgPSBlLmtleS50b1VwcGVyQ2FzZSgpO1xuICAgIGlmKCFnYW1lLnBhdXNlZCkge1xuICAgICAgICBnYW1lLmNoZWNrUHJlc3NlZEtleShwcmVzc2VkS2V5KTtcbiAgICAgICAgZ2FtZS5zZXRSYW5kb21LZXkoKTtcbiAgICAgICAgZ2FtZS5zZXRUaW1lcigpO1xuICAgIH1cbn0pO1xuXG5idXR0b25zQ29udGFpbmVyRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGV2ZW50ID0+IHtcbiAgICBpZihldmVudC50YXJnZXQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCAmJiBldmVudC50YXJnZXQuZGF0YXNldC5hY3Rpb24gIT09ICcnKSB7XG4gICAgICAgIGlmKGV2ZW50LnRhcmdldC5kYXRhc2V0LmFjdGlvbiA9PT0gJ3N0YXJ0JykgZ2FtZS5idXR0b25TdGFydCgpO1xuICAgICAgICBpZihldmVudC50YXJnZXQuZGF0YXNldC5hY3Rpb24gPT09ICdlbmQnKSBnYW1lLmJ1dHRvbkVuZCgpO1xuICAgICAgICBpZihldmVudC50YXJnZXQuZGF0YXNldC5hY3Rpb24gPT09ICdyZXN0YXJ0JykgZ2FtZS5idXR0b25SZXN0YXJ0KCk7XG4gICAgfVxufSkhO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9